Using config:
{'B_VALIDATION': False,
 'CLIP': False,
 'CONFIG_NAME': 'DAMSM',
 'CUDA': True,
 'DATASET_NAME': 'Face',
 'DATA_DIR': '../data/Face',
 'GAN': {'B_ATTENTION': True,
         'B_DCGAN': False,
         'CONDITION_DIM': 100,
         'DF_DIM': 64,
         'GF_DIM': 128,
         'R_NUM': 2,
         'Z_DIM': 100},
 'GPU_ID': 0,
 'RNN_TYPE': 'LSTM',
 'TEXT': {'CAPTIONS_PER_IMAGE': 1, 'EMBEDDING_DIM': 512, 'WORDS_NUM': 36},
 'TRAIN': {'BATCH_SIZE': 48,
           'B_NET_D': True,
           'DISCRIMINATOR_LR': 0.0002,
           'ENCODER_LR': 0.002,
           'FLAG': True,
           'GENERATOR_LR': 0.0002,
           'MAX_EPOCH': 30,
           'NET_E': '',
           'NET_G': '',
           'RNN_GRAD_CLIP': 0.25,
           'SMOOTH': {'GAMMA1': 4.0,
                      'GAMMA2': 5.0,
                      'GAMMA3': 10.0,
                      'LAMBDA': 1.0},
           'SNAPSHOT_INTERVAL': 5},
 'TREE': {'BASE_SIZE': 299, 'BRANCH_NUM': 1},
 'WORKERS': 4}
Load filenames from: ../data/Face/train/filenames.pickle (3261)
Load filenames from: ../data/Face/test/filenames.pickle (815)
Load from:  ../data/Face/captions.pickle
1091 1
Load filenames from: ../data/Face/train/filenames.pickle (3261)
Load filenames from: ../data/Face/test/filenames.pickle (815)
Load from:  ../data/Face/captions.pickle
Load pretrained model from  https://download.pytorch.org/models/inception_v3_google-1a9a5a14.pth
| epoch   0 |     0/   67 batches | ms/batch 17.14 | s_loss  0.02  0.02 | w_loss  0.03  0.02
-----------------------------------------------------------------------------------------
| end epoch   0 | valid loss  7.19  7.50 | lr 0.00200|
-----------------------------------------------------------------------------------------
Save G/Ds models.
| epoch   1 |     0/   67 batches | ms/batch  4.54 | s_loss  0.02  0.02 | w_loss  0.02  0.02
-----------------------------------------------------------------------------------------
| end epoch   1 | valid loss  6.54  6.40 | lr 0.00196|
-----------------------------------------------------------------------------------------
| epoch   2 |     0/   67 batches | ms/batch  4.41 | s_loss  0.01  0.02 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch   2 | valid loss  5.85  5.56 | lr 0.00192|
-----------------------------------------------------------------------------------------
| epoch   3 |     0/   67 batches | ms/batch  4.39 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch   3 | valid loss  5.61  5.11 | lr 0.00188|
-----------------------------------------------------------------------------------------
| epoch   4 |     0/   67 batches | ms/batch  4.41 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch   4 | valid loss  5.43  4.90 | lr 0.00184|
-----------------------------------------------------------------------------------------
| epoch   5 |     0/   67 batches | ms/batch  4.46 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch   5 | valid loss  5.33  4.62 | lr 0.00181|
-----------------------------------------------------------------------------------------
Save G/Ds models.
| epoch   6 |     0/   67 batches | ms/batch  4.63 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch   6 | valid loss  5.22  4.56 | lr 0.00177|
-----------------------------------------------------------------------------------------
| epoch   7 |     0/   67 batches | ms/batch  4.41 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch   7 | valid loss  5.21  4.45 | lr 0.00174|
-----------------------------------------------------------------------------------------
| epoch   8 |     0/   67 batches | ms/batch  4.36 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch   8 | valid loss  5.12  4.25 | lr 0.00170|
-----------------------------------------------------------------------------------------
| epoch   9 |     0/   67 batches | ms/batch  4.36 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch   9 | valid loss  5.18  4.33 | lr 0.00167|
-----------------------------------------------------------------------------------------
| epoch  10 |     0/   67 batches | ms/batch  4.43 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch  10 | valid loss  5.04  4.26 | lr 0.00163|
-----------------------------------------------------------------------------------------
Save G/Ds models.
| epoch  11 |     0/   67 batches | ms/batch  4.49 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch  11 | valid loss  4.96  4.28 | lr 0.00160|
-----------------------------------------------------------------------------------------
| epoch  12 |     0/   67 batches | ms/batch  4.38 | s_loss  0.01  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  12 | valid loss  4.97  4.17 | lr 0.00157|
-----------------------------------------------------------------------------------------
| epoch  13 |     0/   67 batches | ms/batch  4.43 | s_loss  0.01  0.01 | w_loss  0.01  0.00
-----------------------------------------------------------------------------------------
| end epoch  13 | valid loss  4.90  3.98 | lr 0.00154|
-----------------------------------------------------------------------------------------
| epoch  14 |     0/   67 batches | ms/batch  4.52 | s_loss  0.01  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  14 | valid loss  5.01  4.28 | lr 0.00151|
-----------------------------------------------------------------------------------------
| epoch  15 |     0/   67 batches | ms/batch  4.62 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch  15 | valid loss  4.95  4.29 | lr 0.00148|
-----------------------------------------------------------------------------------------
Save G/Ds models.
| epoch  16 |     0/   67 batches | ms/batch  4.56 | s_loss  0.01  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  16 | valid loss  4.97  4.10 | lr 0.00145|
-----------------------------------------------------------------------------------------
| epoch  17 |     0/   67 batches | ms/batch  4.44 | s_loss  0.01  0.01 | w_loss  0.01  0.00
-----------------------------------------------------------------------------------------
| end epoch  17 | valid loss  4.87  4.07 | lr 0.00142|
-----------------------------------------------------------------------------------------
| epoch  18 |     0/   67 batches | ms/batch  4.48 | s_loss  0.01  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  18 | valid loss  4.87  4.07 | lr 0.00139|
-----------------------------------------------------------------------------------------
| epoch  19 |     0/   67 batches | ms/batch  4.39 | s_loss  0.01  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  19 | valid loss  4.83  4.14 | lr 0.00136|
-----------------------------------------------------------------------------------------
| epoch  20 |     0/   67 batches | ms/batch  4.38 | s_loss  0.01  0.01 | w_loss  0.01  0.01
-----------------------------------------------------------------------------------------
| end epoch  20 | valid loss  4.84  4.11 | lr 0.00134|
-----------------------------------------------------------------------------------------
Save G/Ds models.
| epoch  21 |     0/   67 batches | ms/batch  4.52 | s_loss  0.01  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  21 | valid loss  4.88  4.23 | lr 0.00131|
-----------------------------------------------------------------------------------------
| epoch  22 |     0/   67 batches | ms/batch  4.40 | s_loss  0.00  0.00 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  22 | valid loss  4.82  4.11 | lr 0.00128|
-----------------------------------------------------------------------------------------
| epoch  23 |     0/   67 batches | ms/batch  4.46 | s_loss  0.00  0.00 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  23 | valid loss  4.84  4.06 | lr 0.00126|
-----------------------------------------------------------------------------------------
| epoch  24 |     0/   67 batches | ms/batch  4.42 | s_loss  0.01  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  24 | valid loss  4.94  4.27 | lr 0.00123|
-----------------------------------------------------------------------------------------
| epoch  25 |     0/   67 batches | ms/batch  4.52 | s_loss  0.00  0.00 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  25 | valid loss  4.79  4.27 | lr 0.00121|
-----------------------------------------------------------------------------------------
Save G/Ds models.
| epoch  26 |     0/   67 batches | ms/batch  4.51 | s_loss  0.00  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  26 | valid loss  4.79  4.03 | lr 0.00118|
-----------------------------------------------------------------------------------------
| epoch  27 |     0/   67 batches | ms/batch  4.33 | s_loss  0.00  0.00 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  27 | valid loss  4.92  4.24 | lr 0.00116|
-----------------------------------------------------------------------------------------
| epoch  28 |     0/   67 batches | ms/batch  4.46 | s_loss  0.00  0.00 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  28 | valid loss  4.90  4.31 | lr 0.00114|
-----------------------------------------------------------------------------------------
| epoch  29 |     0/   67 batches | ms/batch  4.40 | s_loss  0.00  0.01 | w_loss  0.00  0.00
-----------------------------------------------------------------------------------------
| end epoch  29 | valid loss  4.87  4.24 | lr 0.00111|
-----------------------------------------------------------------------------------------
